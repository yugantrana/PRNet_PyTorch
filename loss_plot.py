import os
from PIL import Image
import numpy as np
import torch
import torchvision
from torch.utils.tensorboard import SummaryWriter

ssim_loss_data= [ 1.11360418, 1.08917331, 0.93697458, 1.23482382, 1.09475553, 1.03238320, 0.78740632, 0.67962491, 0.60292816, 0.55318379, 0.51337945, 0.54641920, 0.41993930, 0.42563024, 0.47744160, 0.37634843, 0.45808571, 0.39507833, 0.38946524, 0.36203977, 0.31258279, 0.30614513, 0.31585836, 0.30231860, 0.31319472, 0.23930320, 0.29073143, 0.30030286, 0.25068283, 0.23013235, 0.22609399, 0.29740718, 0.24213485, 0.26550069, 0.18478128, 0.18640217, 0.23438997, 0.18364232, 0.21538239, 0.18021401, 0.26550954, 0.19762276, 0.19784523, 0.20143607, 0.19650602, 0.15505345, 0.16634346, 0.17409323, 0.23004023, 0.17251291, 0.16745668, 0.17957068, 0.14987275, 0.16161656, 0.16375088, 0.18230260, 0.16048023, 0.15740668, 0.18669150, 0.17776387, 0.13909880, 0.15832467, 0.15230482, 0.11993995, 0.14264717, 0.14706371, 0.13134804, 0.12326000, 0.15356409, 0.14898666, 0.19067423, 0.14332951, 0.16488058, 0.12355853, 0.13290542, 0.12471231, 0.11588055, 0.12185265, 0.12379039, 0.09969459, 0.11705294, 0.10402306, 0.14161159, 0.10462988, 0.10772592, 0.10061141, 0.10126353, 0.13543401, 0.10315734, 0.11468843, 0.11518019, 0.12033747, 0.10039943, 0.13348545, 0.11814466, 0.10329860, 0.09414989, 0.10966807, 0.11139272, 0.10142970, 0.11906273, 0.10544921, 0.11190685, 0.08274812, 0.11293992, 0.08119033, 0.09592555, 0.08968460, 0.06804057, 0.08384905, 0.10049811, 0.07687374, 0.09971451, 0.08890681, 0.08881098, 0.09264852, 0.11429003, 0.07463776, 0.08825678, 0.08408936, 0.10560364, 0.10547181, 0.11865010, 0.10412327, 0.08390561, 0.07748276, 0.09611368, 0.07284627, 0.09847498, 0.08527774, 0.09217181, 0.08633553, 0.07806217, 0.07208335, 0.06710286, 0.07904116, 0.07642165, 0.09339916, 0.06754268, 0.08859620, 0.07665486, 0.07052014, 0.09038829, 0.06795705, 0.07523964, 0.06801301, 0.07058198, 0.06782399, 0.07911057, 0.05581274, 0.07185428, 0.08441843, 0.09919907, 0.08545155, 0.06556320, 0.07618699, 0.06523617, 0.07417812, 0.05642465, 0.07517588, 0.05630221, 0.07702258, 0.07892895, 0.05226105, 0.05522398, 0.05900860, 0.09179379, 0.09354531, 0.06442107, 0.06203490, 0.06888174, 0.06078221, 0.07144354, 0.06246146, 0.07292711, 0.06399194, 0.04624837, 0.06983456, 0.06179552, 0.07949803, 0.05470727, 0.06168346, 0.06465381, 0.06071203, 0.08942952, 0.06957098, 0.04931878, 0.05931067, 0.06514515, 0.06791670, 0.06676314, 0.05608182, 0.04711151, 0.09685467, 0.07289321, 0.05218671, 0.05699704, 0.06532041, 0.05981058, 0.08534077, 0.05779366, 0.09766037, 0.05613392, 0.05216792, 0.05250754, 0.07262939, 0.04287453, 0.04903476, 0.06800089, 0.05385761, 0.06675440, 0.05692739, 0.07007209, 0.08387453, 0.05396988, 0.05675922, 0.04284663, 0.04809815, 0.07716988, 0.04955660, 0.07969699, 0.05414479, 0.04339756, 0.05299196, 0.06397228, 0.07142477, 0.06476546, 0.04884400, 0.05464905, 0.05493436, 0.07565176, 0.04901757, 0.05434862, 0.04889597, 0.06737975, 0.05130191, 0.03993485, 0.06597822, 0.05550476, 0.06294644, 0.04088348, 0.04792436, 0.03646299, 0.05121821, 0.05115278, 0.04194344, 0.05684228, 0.05305320, 0.03792157, 0.05319142, 0.04417430, 0.05445858, 0.05035294, 0.03704063, 0.04315289, 0.04635869, 0.06137821, 0.05426615, 0.03766354, 0.04609754, 0.05566152, 0.05749355, 0.04884544, 0.06294007, 0.04749627, 0.04149062, 0.05275925, 0.04350971, 0.05126666, 0.04045931, 0.05865844, 0.04244262, 0.06010778, 0.03594542, 0.05020234, 0.04713651, 0.04949960, 0.05917602, 0.05135325, 0.04093198, 0.04194251, 0.04747950, 0.04135470, 0.04159992, 0.05000729, 0.03796982, 0.04075717, 0.03902322, 0.04011262, 0.04589934, 0.04842709, 0.04740709, 0.03699403, 0.04129087, 0.05106921, 0.06897157, 0.03478793, 0.04983645, 0.04205424, 0.03523060, 0.04437284, 0.04586513, 0.04207631, 0.03714717, 0.05338777, 0.04872902, 0.03140132, 0.04902979, 0.03963460, 0.03660426, 0.04309739, 0.03664779, 0.04709308, 0.05852563, 0.04751314, 0.05297010, 0.04613572, 0.03511962, 0.03587880, 0.03384141, 0.04584744, 0.03728489, 0.03328908, 0.04480043, 0.03640152, 0.03602820, 0.06401740, 0.03748839, 0.03079175, 0.03211313, 0.02616807, 0.03172741, 0.04032101, 0.04599099, 0.04328455, 0.03934710, 0.03740105, 0.02613784, 0.05947756, 0.03015455, 0.03328961, 0.02962890, 0.04463188, 0.03058182, 0.03606118, 0.05294997, 0.04689848, 0.05251572, 0.03954099, 0.03727251, 0.03514226, 0.04718199, 0.04225688, 0.02403739, 0.03970235, 0.04456162, 0.04498285, 0.03230491, 0.03202160, 0.02449094, 0.02946211, 0.02597885, 0.02481647, 0.05242697, 0.04868491, 0.04659546, 0.03533510, 0.04487269, 0.06231282, 0.04045646, 0.03531937, 0.03137214, 0.03722698, 0.03034836, 0.03910887, 0.03543150, 0.04076563, 0.02990470, 0.03261252, 0.03773937, 0.04389002, 0.03581737, 0.05163017, 0.03328080, 0.03380516, 0.03537253, 0.06469203, 0.03850813, 0.03758381, 0.03214895, 0.05119074, 0.04009181, 0.04401285, 0.04238382, 0.03535792, 0.04508458, 0.03912705, 0.02452019, 0.02608402, 0.04026284, 0.04237022, 0.05278079, 0.03721138, 0.02606961, 0.03258416, 0.03444615, 0.03087384, 0.03086742, 0.02367581, 0.04738999, 0.03212998, 0.02956537, 0.02867134, 0.04093414, 0.03633265, 0.02968091, 0.02743438, 0.04817165, 0.02997476, 0.03598678, 0.03981029, 0.02842439, 0.02559280, 0.03151567, 0.03261544, 0.02609761, 0.03889432, 0.02303967, 0.03563314, 0.05238778, 0.05347546, 0.03429652, 0.03270601, 0.04694223, 0.03012719, 0.03580855, 0.03300986, 0.02789077, 0.04439598, 0.02848566, 0.02677598, 0.03035733, 0.03476117, 0.04141785, 0.05125876, 0.03224583, 0.03552388, 0.03209653, 0.03404540, 0.04151191, 0.03087764, 0.03484890, 0.03451761, 0.03449362, 0.04867097, 0.05007227, 0.02971692, 0.04346832, 0.02522166, 0.03544331, 0.03488266, 0.04526398, 0.03688076, 0.03000632, 0.04298514, 0.04542950, 0.06232456, 0.03174750, 0.02695217, 0.04708095, 0.03958976, 0.02196453, 0.04392459, 0.03029292, 0.03036837, 0.03074004, 0.03924240, 0.02364325, 0.04560593, 0.03541665, 0.03543343, 0.02921782, 0.02457856, 0.02366128, 0.02973328, 0.02234704, 0.03569968, 0.03429392, 0.02149529, 0.03106394, 0.04431824, 0.04204354, 0.02444059, 0.03043208, 0.02745941, 0.02508826, 0.02171546, 0.03275406, 0.03275406 ]
original_loss_data = [ 2.03378200, 1.84920859, 1.65400099, 1.58441185, 1.56616568, 1.55141639, 1.56965756, 1.45556581, 1.43499958, 1.37656998, 1.51915633, 1.27346122, 1.06691753, 1.15516901, 0.91951763, 0.99626141, 0.96593385, 0.84300220, 0.85620856, 0.91176962, 0.78656297, 0.62882995, 0.68581002, 0.70965182, 0.58648830, 0.76341509, 0.85205805, 0.77208036, 0.67656648, 0.72180420, 0.61010140, 0.64598190, 0.67354249, 0.67750787, 0.63266175, 0.58212268, 0.53437018, 0.52742958, 0.58139419, 0.70979648, 0.56485176, 0.59529840, 0.62889468, 0.65905529, 0.71620053, 0.83542495, 0.72836935, 0.48142549, 0.53415751, 0.47746691, 0.44709938, 0.57068985, 0.49546182, 0.48288410, 0.53965711, 0.45112141, 0.52657008, 0.43724733, 0.58491086, 0.52093863, 0.52944743, 0.50073230, 0.66194844, 0.48245269, 0.49088916, 0.56266063, 0.44644564, 0.50252103, 0.43588620, 0.44999238, 0.44809663, 0.34042489, 0.40422523, 0.41151297, 0.43380057, 0.57470679, 0.33808004, 0.30810940, 0.32106775, 0.36760407, 0.39317548, 0.34624230, 0.39034351, 0.48405051, 0.33367449, 0.47861349, 0.48954939, 0.37966170, 0.36440834, 0.40865099, 0.35594782, 0.31302869, 0.34507787, 0.41471567, 0.28875148, 0.39384835, 0.28527370, 0.37145647, 0.40124383, 0.30086416, 0.26108291, 0.35490381, 0.34635639, 0.31029918, 0.33133608, 0.26511898, 0.34308201, 0.32873278, 0.22918054, 0.39876848, 0.41937506, 0.36359214, 0.42294329, 0.35740807, 0.40597084, 0.30205956, 0.29195123, 0.44022476, 0.33606135, 0.25847035, 0.28727281, 0.24569000, 0.24565292, 0.30218777, 0.32467439, 0.23684282, 0.29496860, 0.35524782, 0.31903818, 0.36258405, 0.23616832, 0.27056223, 0.27542698, 0.31012138, 0.26266115, 0.29249185, 0.28174248, 0.26552429, 0.21473512, 0.27216711, 0.20594233, 0.24422118, 0.19660589, 0.23941507, 0.24235850, 0.33152654, 0.20499344, 0.27658432, 0.32428017, 0.23251987, 0.24032461, 0.20498993, 0.23313382, 0.19796055, 0.25537681, 0.36562392, 0.17067867, 0.22378255, 0.17387449, 0.22345793, 0.20449522, 0.18031460, 0.21561455, 0.26228851, 0.25614345, 0.20063009, 0.23373681, 0.17779494, 0.23399315, 0.19144713, 0.23704221, 0.22494095, 0.22628170, 0.15682482, 0.21225433, 0.18513375, 0.29458433, 0.27728870, 0.22233828, 0.17123728, 0.20293483, 0.16672031, 0.20209982, 0.16293129, 0.23397466, 0.18293181, 0.22581639, 0.18253539, 0.21722085, 0.23354981, 0.26355323, 0.19670420, 0.15974155, 0.19607940, 0.20344913, 0.16057342, 0.15319323, 0.21189644, 0.14390005, 0.16654968, 0.22122398, 0.15300659, 0.16917860, 0.12187468, 0.16396476, 0.17937551, 0.15178492, 0.17411823, 0.20558027, 0.19544722, 0.16287845, 0.14246365, 0.17744967, 0.17103260, 0.17086176, 0.16853319, 0.22728927, 0.25565853, 0.15752884, 0.19184094, 0.25036734, 0.13148042, 0.16632734, 0.14296409, 0.15428587, 0.16325151, 0.15527769, 0.12716023, 0.13840630, 0.13345408, 0.22045229, 0.23667588, 0.18387317, 0.13073107, 0.19378581, 0.21058520, 0.14343892, 0.14518786, 0.14697971, 0.14564895, 0.17635551, 0.13101872, 0.13955016, 0.14520823, 0.15422786, 0.12135537, 0.14559571, 0.11029800, 0.10163967, 0.13059028, 0.12565912, 0.17585793, 0.11662524, 0.11570899, 0.14025090, 0.12281793, 0.11440470, 0.12208979, 0.10637694, 0.08825577, 0.14397409, 0.10839162, 0.16250979, 0.09763412, 0.22081011, 0.18096631, 0.11295820, 0.15339258, 0.13645443, 0.08763758, 0.13058550, 0.14298102, 0.16436243, 0.11238748, 0.11001291, 0.13702230, 0.11971439, 0.10422122, 0.10931155, 0.17096090, 0.12396445, 0.09575833, 0.15840715, 0.11354920, 0.07392667, 0.08160376, 0.16359233, 0.11977487, 0.12854979, 0.12142258, 0.12093469, 0.14305087, 0.12062603, 0.08206880, 0.17530684, 0.17932443, 0.13812649, 0.18395677, 0.09082555, 0.09844262, 0.09761910, 0.08093899, 0.08856169, 0.12485538, 0.13586369, 0.09359483, 0.12331099, 0.08643288, 0.10297916, 0.10968755, 0.14103622, 0.11292785, 0.08173362, 0.10567991, 0.08431997, 0.08959735, 0.10217930, 0.11010015, 0.11070320, 0.07435787, 0.07871945, 0.08268049, 0.07376530, 0.06776775, 0.08849923, 0.07089936, 0.20489321, 0.14182671, 0.07992254, 0.07287807, 0.11688286, 0.10416988, 0.09024435, 0.17093925, 0.10694436, 0.13831815, 0.09593804, 0.09517429, 0.06588307, 0.09279300, 0.10381492, 0.11135603, 0.11453247, 0.05050110, 0.07495808, 0.08046918, 0.10001424, 0.09608536, 0.08283057, 0.10368894, 0.07437415, 0.09535236, 0.07487338, 0.09098121, 0.07479493, 0.10020947, 0.07979767, 0.06080175, 0.11868963, 0.08007670, 0.07582017, 0.10409244, 0.11025263, 0.05307694, 0.08673642, 0.07581555, 0.07326865, 0.09693953, 0.07316546, 0.07942526, 0.10267152, 0.14631441, 0.06954847, 0.11351747, 0.07629117, 0.07538142, 0.08549432, 0.06306657, 0.12363462, 0.09633918, 0.06086596, 0.07333417, 0.09023427, 0.09953747, 0.06403145, 0.08053175, 0.07736584, 0.05792038, 0.05859367, 0.09299254, 0.06975457, 0.06520377, 0.06689541, 0.07072547, 0.10224872, 0.05910512, 0.12340077, 0.05691514, 0.05109303, 0.07005897, 0.06616684, 0.06915019, 0.12875196, 0.08438427, 0.06279094, 0.10569214, 0.06777454, 0.07027269, 0.05937874, 0.08255600, 0.07475274, 0.05330371, 0.07496554, 0.12235879, 0.07710611, 0.08129286, 0.06220078, 0.08156257, 0.06867403, 0.10844039, 0.06687878 ]

def plot_loss():
	writer = SummaryWriter("./mobruns")
	for ep in range(421):
		ssim_loss = ssim_loss_data[ep]
		original_loss = original_loss_data[ep]
		writer.add_scalar("Original loss", np.array(original_loss), ep)
		writer.add_scalar("SSIM loss", np.array(ssim_loss), ep)
		if ep%10 == 0:
			target_dir = "./mobresults/ep{}/images".format(ep)
			for file in os.listdir(target_dir):
				img_path = os.path.join(target_dir, file)
				img = Image.open(img_path).convert('RGB')
				img_tensor = torchvision.transforms.ToTensor()(img)
				writer.add_image(file, img_tensor, ep)
		print("Logged Results for epoch ", ep)

if __name__ == "__main__":
	plot_loss()