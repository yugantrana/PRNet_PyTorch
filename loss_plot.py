import os
from PIL import Image
import numpy as np
import torch
import torchvision
from torch.utils.tensorboard import SummaryWriter

ssim_loss_data= [ 1.11360418, 1.08917331, 0.93697458, 1.23482382, 1.09475553, 1.03238320, 0.78740632, 0.67962491, 0.60292816, 0.55318379, 0.51337945, 0.54641920, 0.41993930, 0.42563024, 0.47744160, 0.37634843, 0.45808571, 0.39507833, 0.38946524, 0.36203977, 0.31258279, 0.30614513, 0.31585836, 0.30231860, 0.31319472, 0.23930320, 0.29073143, 0.30030286, 0.25068283, 0.23013235, 0.22609399, 0.29740718, 0.24213485, 0.26550069, 0.18478128, 0.18640217, 0.23438997, 0.18364232, 0.21538239, 0.18021401, 0.26550954, 0.19762276, 0.19784523, 0.20143607, 0.19650602, 0.15505345, 0.16634346, 0.17409323, 0.23004023, 0.17251291, 0.16745668, 0.17957068, 0.14987275, 0.16161656, 0.16375088, 0.18230260, 0.16048023, 0.15740668, 0.18669150, 0.17776387, 0.13909880, 0.15832467, 0.15230482, 0.11993995, 0.14264717, 0.14706371, 0.13134804, 0.12326000, 0.15356409, 0.14898666, 0.19067423, 0.14332951, 0.16488058, 0.12355853, 0.13290542, 0.12471231, 0.11588055, 0.12185265, 0.12379039, 0.09969459, 0.11705294, 0.10402306, 0.14161159, 0.10462988, 0.10772592, 0.10061141, 0.10126353, 0.13543401, 0.10315734, 0.11468843, 0.11518019, 0.12033747, 0.10039943, 0.13348545, 0.11814466, 0.10329860, 0.09414989, 0.10966807, 0.11139272, 0.10142970, 0.11906273, 0.10544921, 0.11190685, 0.08274812, 0.11293992, 0.08119033, 0.09592555, 0.08968460, 0.06804057, 0.08384905, 0.10049811, 0.07687374, 0.09971451, 0.08890681, 0.08881098, 0.09264852, 0.11429003, 0.07463776, 0.08825678, 0.08408936, 0.10560364, 0.10547181, 0.11865010, 0.10412327, 0.08390561, 0.07748276, 0.09611368, 0.07284627, 0.09847498, 0.08527774, 0.09217181, 0.08633553, 0.07806217, 0.07208335, 0.06710286, 0.07904116, 0.07642165, 0.09339916, 0.06754268, 0.08859620, 0.07665486, 0.07052014, 0.09038829, 0.06795705, 0.07523964, 0.06801301, 0.07058198, 0.06782399, 0.07911057, 0.05581274, 0.07185428, 0.08441843, 0.09919907, 0.08545155, 0.06556320, 0.07618699, 0.06523617, 0.07417812, 0.05642465, 0.07517588, 0.05630221, 0.07702258, 0.07892895, 0.05226105, 0.05522398, 0.05900860, 0.09179379, 0.09354531, 0.06442107, 0.06203490, 0.06888174, 0.06078221, 0.07144354, 0.06246146, 0.07292711, 0.06399194, 0.04624837, 0.06983456, 0.06179552, 0.07949803, 0.05470727, 0.06168346, 0.06465381, 0.06071203, 0.08942952, 0.06957098, 0.04931878, 0.05931067, 0.06514515, 0.06791670, 0.06676314, 0.05608182, 0.04711151, 0.09685467, 0.07289321, 0.05218671, 0.05699704, 0.06532041, 0.05981058, 0.08534077, 0.05779366, 0.09766037, 0.05613392, 0.05216792, 0.05250754, 0.07262939, 0.04287453, 0.04903476, 0.06800089, 0.05385761, 0.06675440, 0.05692739, 0.07007209, 0.08387453, 0.05396988, 0.05675922, 0.04284663, 0.04809815, 0.07716988, 0.04955660, 0.07969699, 0.05414479, 0.04339756, 0.05299196, 0.06397228, 0.07142477, 0.06476546, 0.04884400, 0.05464905, 0.05493436, 0.07565176, 0.04901757, 0.05434862, 0.04889597, 0.06737975, 0.05130191, 0.03993485, 0.06597822, 0.05550476, 0.06294644, 0.04088348, 0.04792436, 0.03646299, 0.05121821, 0.05115278, 0.04194344, 0.05684228, 0.05305320, 0.03792157, 0.05319142, 0.04417430, 0.05445858, 0.05035294, 0.03704063, 0.04315289, 0.04635869, 0.06137821, 0.05426615, 0.03766354, 0.04609754, 0.05566152, 0.05749355, 0.04884544, 0.06294007, 0.04749627, 0.04149062, 0.05275925, 0.04350971, 0.05126666, 0.04045931, 0.05865844, 0.04244262, 0.06010778, 0.03594542, 0.05020234, 0.04713651, 0.04949960, 0.05917602, 0.05135325, 0.04093198, 0.04194251, 0.04747950, 0.04135470, 0.04159992, 0.05000729, 0.03796982, 0.04075717, 0.03902322, 0.04011262, 0.04589934, 0.04842709, 0.04740709, 0.03699403, 0.04129087, 0.05106921, 0.06897157, 0.03478793, 0.04983645, 0.04205424, 0.03523060, 0.04437284, 0.04586513, 0.04207631, 0.03714717, 0.05338777, 0.04872902, 0.03140132, 0.04902979, 0.03963460, 0.03660426, 0.04309739, 0.03664779, 0.04709308, 0.05852563, 0.04751314, 0.05297010, 0.04613572, 0.03511962, 0.03587880, 0.03384141, 0.04584744, 0.03728489, 0.03328908, 0.04480043, 0.03640152, 0.03602820, 0.06401740, 0.03748839, 0.03079175, 0.03211313, 0.02616807, 0.03172741, 0.04032101, 0.04599099, 0.04328455, 0.03934710, 0.03740105, 0.02613784, 0.05947756, 0.03015455, 0.03328961, 0.02962890, 0.04463188, 0.03058182, 0.03606118, 0.05294997, 0.04689848, 0.05251572, 0.03954099, 0.03727251, 0.03514226, 0.04718199, 0.04225688, 0.02403739, 0.03970235, 0.04456162, 0.04498285, 0.03230491, 0.03202160, 0.02449094, 0.02946211, 0.02597885, 0.02481647, 0.05242697, 0.04868491, 0.04659546, 0.03533510, 0.04487269, 0.06231282, 0.04045646, 0.03531937, 0.03137214, 0.03722698, 0.03034836, 0.03910887, 0.03543150, 0.04076563, 0.02990470, 0.03261252, 0.03773937, 0.04389002, 0.03581737, 0.05163017, 0.03328080, 0.03380516, 0.03537253, 0.06469203, 0.03850813, 0.03758381, 0.03214895, 0.05119074, 0.04009181, 0.04401285, 0.04238382, 0.03535792, 0.04508458, 0.03912705, 0.02452019, 0.02608402, 0.04026284, 0.04237022, 0.05278079, 0.03721138, 0.02606961, 0.03258416, 0.03444615, 0.03087384, 0.03086742, 0.02367581, 0.04738999, 0.03212998, 0.02956537, 0.02867134, 0.04093414, 0.03633265, 0.02968091, 0.02743438, 0.04817165, 0.02997476, 0.03598678, 0.03981029, 0.02842439, 0.02559280, 0.03151567, 0.03261544, 0.02609761, 0.03889432, 0.02303967, 0.03563314, 0.05238778, 0.05347546, 0.03429652, 0.03270601, 0.04694223, 0.03012719, 0.03580855, 0.03300986, 0.02789077, 0.04439598, 0.02848566, 0.02677598, 0.03035733, 0.03476117, 0.04141785, 0.05125876, 0.03224583, 0.03552388, 0.03209653, 0.03404540, 0.04151191, 0.03087764, 0.03484890, 0.03451761, 0.03449362, 0.04867097, 0.05007227, 0.02971692, 0.04346832, 0.02522166, 0.03544331, 0.03488266, 0.04526398, 0.03688076, 0.03000632, 0.04298514, 0.04542950, 0.06232456, 0.03174750, 0.02695217, 0.04708095, 0.03958976, 0.02196453, 0.04392459, 0.03029292, 0.03036837, 0.03074004, 0.03924240, 0.02364325, 0.04560593, 0.03541665, 0.03543343, 0.02921782, 0.02457856, 0.02366128, 0.02973328, 0.02234704, 0.03569968, 0.03429392, 0.02149529, 0.03106394, 0.04431824, 0.04204354, 0.02444059, 0.03043208, 0.02745941, 0.02508826, 0.02171546, 0.03275406, 0.03275406 ]
original_loss_data = [ 0.70063203, 0.61418026, 0.48053720, 0.40075343, 0.38578015, 0.23016467, 0.17008402, 0.17737236, 0.16163232, 0.13158549, 0.13047976, 0.16766548, 0.09644343, 0.09355076, 0.10973054, 0.08226047, 0.12342397, 0.07045826, 0.09947366, 0.07680754, 0.05351790, 0.05072205, 0.06199061, 0.05680684, 0.05139151, 0.03705276, 0.04033238, 0.03813634, 0.03306638, 0.03362764, 0.03234695, 0.05434912, 0.03393545, 0.04046738, 0.02276537, 0.02693067, 0.02802704, 0.03138224, 0.02752798, 0.02611750, 0.05208063, 0.03041238, 0.03135754, 0.02488784, 0.02598489, 0.01577728, 0.02785215, 0.02364294, 0.05542369, 0.02179026, 0.03195902, 0.02537658, 0.03180835, 0.02572667, 0.01763528, 0.02484258, 0.02977592, 0.01601767, 0.02985386, 0.02603355, 0.01503129, 0.01807846, 0.02064184, 0.01754158, 0.02858964, 0.02744729, 0.01486836, 0.01675593, 0.02101810, 0.01717032, 0.02584461, 0.02032699, 0.01636548, 0.01551500, 0.01453009, 0.01555846, 0.01692318, 0.01463982, 0.01304714, 0.01303536, 0.01725916, 0.01168521, 0.02026969, 0.01506314, 0.01923366, 0.01319849, 0.01823753, 0.01394224, 0.01266900, 0.01152785, 0.00987265, 0.01241362, 0.01092203, 0.01241287, 0.01644378, 0.01575374, 0.01033783, 0.01232934, 0.01136083, 0.01265130, 0.01746611, 0.01581717, 0.00937127, 0.01073762, 0.01441247, 0.00858462, 0.01108291, 0.01335515, 0.00875449, 0.01129507, 0.00776595, 0.00991659, 0.01370105, 0.01078768, 0.01022401, 0.01139979, 0.01686410, 0.00773441, 0.01072482, 0.01358115, 0.01206831, 0.00879938, 0.00873260, 0.01659459, 0.00917186, 0.01280490, 0.00645597, 0.00796164, 0.01330292, 0.01113774, 0.01673369, 0.00886384, 0.00690131, 0.00813863, 0.01018346, 0.01143815, 0.00824350, 0.00716138, 0.00940862, 0.00572890, 0.00571728, 0.00876211, 0.00968627, 0.01024803, 0.00873156, 0.00681605, 0.00668109, 0.00726397, 0.00593477, 0.00808328, 0.00766859, 0.00809913, 0.01161166, 0.00868834, 0.00898753, 0.00803124, 0.00529934, 0.00557303, 0.00678189, 0.00649133, 0.00740488, 0.01076836, 0.01026688, 0.00548746, 0.00586486, 0.00812466, 0.00639896, 0.01029418, 0.00981309, 0.00554387, 0.00692959, 0.00714273, 0.01035601, 0.00532934, 0.00617837, 0.00740225, 0.00578100, 0.00849026, 0.00633951, 0.00591363, 0.00564370, 0.00434894, 0.00646835, 0.00623654, 0.00803889, 0.00661087, 0.00575556, 0.00623862, 0.00603246, 0.00756318, 0.00701325, 0.00777988, 0.00419231, 0.01650654, 0.00623375, 0.00422525, 0.00496508, 0.00949034, 0.00636028, 0.00775687, 0.00548127, 0.01034360, 0.00530748, 0.00685998, 0.00373630, 0.00478072, 0.00467589, 0.00488937, 0.00674203, 0.00466263, 0.00488377, 0.00469631, 0.01416037, 0.00722856, 0.00457897, 0.00567064, 0.00503618, 0.00498725, 0.01171519, 0.00440492, 0.00766415, 0.00587800, 0.00305999, 0.00486241, 0.00556127, 0.00475488, 0.00660444, 0.00589436, 0.00376457, 0.00652732, 0.00633727, 0.00480742, 0.00349876, 0.00412696, 0.00505265, 0.00547987, 0.00398845, 0.00549303, 0.00278501, 0.00562002, 0.00388163, 0.00405769, 0.00352732, 0.00624743, 0.00430760, 0.00480604, 0.00576066, 0.00431740, 0.00347459, 0.00633957, 0.00344325, 0.00382823, 0.00582812, 0.00337785, 0.00353027, 0.00339690, 0.00435162, 0.00266050, 0.00409359, 0.00489586, 0.00467121, 0.00268338, 0.00407260, 0.00346274, 0.00424161, 0.00415453, 0.00393633, 0.00362568, 0.00449248, 0.00297923, 0.00380393, 0.00385749, 0.00609545, 0.00390403, 0.00433608, 0.00565442, 0.00312696, 0.00264843, 0.00301866, 0.00384283, 0.00390786, 0.00226106, 0.00399457, 0.00386141, 0.00251708, 0.00437497, 0.00424411, 0.00421813, 0.00248136, 0.00261946, 0.00357268, 0.00320797, 0.00502047, 0.00321554, 0.00425809, 0.00536814, 0.00238834, 0.00318330, 0.00419339, 0.00312087, 0.00274383, 0.00379115, 0.00427473, 0.00388467, 0.00309346, 0.00258099, 0.00321686, 0.00391360, 0.00338491, 0.00617244, 0.00398093, 0.00338251, 0.00368501, 0.00610773, 0.00289417, 0.00376106, 0.00210922, 0.00372194, 0.00256086, 0.00233729, 0.00274257, 0.00275644, 0.00340613, 0.00314224, 0.00321560, 0.00860616, 0.00479038, 0.00287646, 0.00223529, 0.00261087, 0.00281805, 0.00312381, 0.00446257, 0.00732104, 0.00359643, 0.00381841, 0.00346726, 0.00207022, 0.00353754, 0.00220022, 0.00237513, 0.00251174, 0.00328209, 0.00315132, 0.00305749, 0.00204393, 0.00245157, 0.00235487, 0.00319776, 0.00198334, 0.00276095, 0.00436051, 0.00282864, 0.00237352, 0.00259327, 0.00668356, 0.00258851, 0.00170671, 0.00246815, 0.00324239, 0.00224440, 0.00215816, 0.00297484, 0.00315571, 0.00338928, 0.00174900, 0.00193327, 0.00643875, 0.00243936, 0.00274505, 0.00248882, 0.00278789, 0.00569071, 0.00266167, 0.00169794, 0.00256999, 0.00276580, 0.00323042, 0.00304006, 0.00299056, 0.00297652, 0.00153183, 0.00359258, 0.00327516, 0.00204326, 0.00334037, 0.00163316, 0.00175720, 0.00411139, 0.00286617, 0.00246972, 0.00270284, 0.00198633, 0.00185495, 0.00453380, 0.00214803, 0.00320211, 0.00158634, 0.00229292, 0.00175513, 0.00197242, 0.00334612, 0.00161771, 0.00196205, 0.00355611, 0.00324775, 0.00331379, 0.00159580, 0.00251692, 0.00206369, 0.00220586, 0.00185351, 0.00182991, 0.00238270, 0.00199154, 0.00211273, 0.00144649, 0.00198299, 0.00171849, 0.00168986, 0.00453143, 0.00181282, 0.00174837, 0.00180885, 0.00196010, 0.00143638, 0.00244461, 0.00172306, 0.00208979, 0.00418852, 0.00173160, 0.00320394, 0.00267016, 0.00622900, 0.00135418, 0.00205202, 0.00285313, 0.00232875, 0.00341192, 0.00139405, 0.00180160, 0.00228830, 0.00266167, 0.00249405, 0.00235892, 0.00174378, 0.00176050, 0.00117334, 0.00166574, 0.00255427, 0.00118390, 0.00170149, 0.00157417, 0.00162803, 0.00328029, 0.00166354, 0.00257732, 0.00197426, 0.00235991, 0.00151173, 0.00257198, 0.00196637, 0.00141389, 0.00113485, 0.00236301, 0.00181672, 0.00195885, 0.00230012, 0.00153112, 0.00159792, 0.00107218, 0.00177708, 0.00146990, 0.00277012, 0.00221038, 0.00166590, 0.00116365, 0.00138487, 0.00193442, 0.00151713, 0.00193771, 0.00173249, 0.00172231, 0.00204954, 0.00152029, 0.00217531, 0.00170738, 0.00165730, 0.00164928, 0.00133073, 0.00215489, 0.00564395, 0.00179263, 0.00352900, 0.00149743, 0.00132611, 0.00133151, 0.00190077, 0.00190077 ]

def plot_loss():
	writer = SummaryWriter("./r18runs")
	for ep in range(499):
		ssim_loss = ssim_loss_data[ep]
		original_loss = original_loss_data[ep]
		writer.add_scalar("Original loss", np.array(original_loss), ep)
		writer.add_scalar("SSIM loss", np.array(ssim_loss), ep)
		if ep%10 == 0:
			target_dir = "./r18results/ep{}/images".format(ep)
			for file in os.listdir(target_dir):
				img_path = os.path.join(target_dir, file)
				img = Image.open(img_path).convert('RGB')
				img_tensor = torchvision.transforms.ToTensor()(img)
				writer.add_image(file, img_tensor, ep)
		print("Logged Results for epoch ", ep)

if __name__ == "__main__":
	plot_loss()